Package: SAIGE
Type: Package
Title: Efficiently controlling for case-control imbalance and sample relatedness in single-variant assoc tests (SAIGE) and controlling for sample relatedness in region-based assoc tests in large cohorts and biobanks (SAIGE-GENE) 
Version: 0.36.5.2
Date: 2020-04-30
Author: Wei Zhou, Seunggeun Lee, Cristen Willer
Maintainer: Wei Zhou <zhowei@umich.edu>
Description: an R package that implements the Scalable and Accurate Implementation of Generalized mixed model that uses the saddlepoint approximation (SPA)(mhof, J. P. , 1961; Kuonen, D. 1999; Dey, R. et.al 2017) and large scale optimization techniques to calibrate case-control ratios in logistic mixed model score tests (Chen, H. et al. 2016) in large PheWAS. Estimated effect sizes are provided. Support VCF,BCF and SAV as input format for dosages using the SAVVY library and support BGEN as input format for dosages using the BGEN library. QR decomposition for the covariate matrix. Allow models with no covariates. Allow using large number of genetic markers to construct GRM (e.g. > 600,000 markers). Fixed a Bug for the Tstat output. Use coefficent of variations for trace estimators and variane ratio estimation. Fixed a bug for colSums() when there is no covariate. BETA and Tstat are now for the alt allele for both quantitative and binary traits. Added an option for leave-one-chromosome-out (LOCO), cut off for the coefficient of variation for trace estimates and variance ratio estimates. Update the savvy library. conditional analysis and gene-based test with sparse GRM. Add option for categorical variance ratio and sparseSigma for single-variant analysis for quantitattive traits. (bianry traits needs more work). Add step 1 using GMMAT package. Work with R-3.5.1. Update eta for fitting null GLMM for binary traits. Add a script createSparseGRM.R to create a sparse GRM. Use sparse matrix for gene-based tests. Fixed a bug for step 1 (updating eta). Replace pcg with solve for sparseGRM. Remove markers with negative variance from gene-based tests. Speed up the step 1 for quantitative traits. Use sparse GRM to estiamte the inital tau. Fix a bug for step 2 when phi is very small. Add the missing arguments cateVarRatioMinMACVecExclude and cateVarRatioMaxMACVecInclude to step 1 functions. Compared to 0.35.5.6, this version has master branch merged in. The following comments are copied from master that are missed since the master-gene was branched out from master.  Update SAIGE as SPAtest library is updated (bug fixed). A bug is fixed in the savvy library for vcf and sav format input. A bug is fixed for step 1 for binary traits, which may not affect much on step 1 results. Break when tau is 0 for quantitative traits in step 1. Add code to check sample size in sample file and dosage file. remove covariates in case of perfect separation. handle missing dosages. 0.35.6.3:add a function to extract the diag of GRM. 0.35.7: clean code. 0.35.8: merge 0.35.7 to 0.29.7 in the master branch. 0.35.8.1: fix some errors in documentation and warning message for binary traits. 0.35.8.2: minor changes-fix error message, change MAC to MAF, add a line to check if the chomosome in plink file is numeric or not, add rsid to the header when input file is bgen. 0.35.8.3: fix a bug in the function getCovM_nopcg, which affected the conditional analysis for binary traits. Merge hyacz/master to use cget to manage superlu.0.35.8.5: implement the function to account for unbalanced case control ratio for gene-based tests. 0.35.8.6: fixed the output bug when the genotype matrix has rank 1 for binary phenotypes and add an argument minMAFtoConstructGRM for step 0 and step 1 to allow users to specify the minumum MAF of markers used to construct GRM. 0.35.8.7: fixed the bug when there is no covariate specified, added an argument IsOutputNinCaseCtrl for step 2 to allow for output sample sizes in cases and controls for binary traits in the output file, and fixed the out of boundary bug for LOCO. 0.35.8.8: Fixes a matrix inversion issue in the null model and adds an optional argument for the null computation to remove binary covariates with low counts by juhis. 0.36.1: 1. fixed the freq calculation for mean impute for missing genotypes in  plinkFile 2. Diagonal elements of GRM are now estimated using markers in plinkFile with MAF >= minMAFforGRM 3. Conditional analysis for gene- or region-based test for binary traits is now accounting for case-control imbalance 4. plain dosage files are no longer supported for step 2 so no external boost_iostream library is needed. 0.36.2: The option weights.beta.common is not fully correctly developed, so we make weights.beta.common equal to weights.beta.rare for now. Instead of output NA for SKAT-O p values when the function SKAT:::Met_SKAT_Get_Pvalue failed, output 2*min(SKAT p, Burden p, 0.5). allow for specifying customized weights for markers in gene- or region-based tests with arguments in step 2: weightsIncludeinGroupFile and weights_for_G2_cond. 0.36.3: Add option IsOutputBETASEinBurdenTest in step 2 to output effect sizes for burden tests. 0.36.3.1: minor changes. 0.36.3.2: output number of heterozytes and homozygotes for bgen input for single-variant assoc tests. 0.36.3.3: add function to perform survival analysis. 0.36.3.4:  obtain diagonal of WminusUinv for preconditioner for pcg, no longer stop the program when varianceRatio file exists. 0.36.3.5: Implement the fast SPA. 0.36.3.6: change q and qinv to Score and -Score in the Poisson SPA. 0.36.3.7: update the sparse GRM version for step1b. 0.36.4: fixed the bug for Dvec and use W0 for inner PCG. 0.36.5: remove intercept and use g_c in var1. 0.36.5.1: comment out code chunk in Get_Coef. 0.36.5.2: tol.Coef = tol
License: GPL (>= 2)
Imports: Rcpp (>= 0.12.12), RcppParallel, Matrix
LinkingTo: Rcpp, RcppArmadillo, RcppParallel, data.table, SPAtest (== 3.0.2),
        RcppEigen, Matrix, methods, BH, optparse, SKAT, MetaSKAT
SystemRequirements: GNU make
RoxygenNote: 7.0.1
NeedsCompilation: yes
Encoding: UTF-8
Packaged: 2020-04-30 13:21:37 UTC; zhowei
